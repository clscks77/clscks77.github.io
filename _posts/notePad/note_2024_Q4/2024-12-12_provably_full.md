---
title: "[Note] 2024-12-12 provably_full.txt"
categories: [Notepad, Daily]
tags: 
date: 2024-12-12 21:49:00 +0900
comments: false
---
---

1. Introduction

그래프 신경망(GNN)은 관계형 데이터로부터 학습하기 위해 가장 많이 사용되는 머신 러닝 모델이 되었습니다. 
GNN은 생물학, 물리학, 화학에서 소셜 네트워크, 교통, 일기 예보에 이르기까지 다양한 분야에서 사용되고 있습니다(Bongini, Bianchini, Scarselli 2021; Zhou 외. 2020; Derrow-Pinion 외. 2021; Shu, Wang, Liu 2019; Wu 외. 2020; Keisler 2022; Zhang 외. 2019; Battaglia 외. 2016). 
최근에는 금융 범죄를 식별하기 위해 GNN을 사용하는 것에 대한 관심이 높아지고 있습니다(Cardoso, Saleiro, Bizarro 2022; Kanezashi 외. 2022; Weber 외. 2019, 2018; Nicholls, Kuppa, Le-Khac 2021). 

저희는 거래 네트워크의 하위 그래프 패턴으로 나타나는 금융 범죄를 탐지하는 것을 목표로 삼고 있습니다. 
예를 들어, 그림 1은 확립된 자금 세탁 패턴을 보여줍니다. 하지만 비슷한 패턴은 화학에서 교통 예측에 이르기까지 다양한 분야의 그래프 작업과 관련이 있다는 점에 유의하세요. 이러한 작업은 GNN을 사용하기에 매우 적합한 것으로 보입니다. 


하지만 안타깝게도 현재의 GNN은 금융 거래 네트워크를 효과적으로 처리하기에는 역부족입니다. 
첫째, 금융 거래 네트워크는 사실 방향성 다중 그래프, 즉 에지(또는 거래)에 방향성이 있고 두 노드(또는 계정) 사이에 여러 개의 에지가 있을 수 있습니다. 
둘째, 대부분의 GNN은 주기와 같은 일부 하위 그래프 패턴을 감지할 수 없습니다(Chen et al. 2020, 2019b). ★
- Chen, Z.; Chen, L.; Villar, S.; and Bruna, J. 2020. Can graph neural networks count substructures? Advances in neural information processing systems, 33: 10383–10395. 
- Chen, Z.; Villar, S.; Chen, L.; and Bruna, J. 2019b. On the equiva- lence between graph isomorphism testing and function approxima- tion with gnns. Advances in neural information processing systems, 32.


이러한 한계를 극복하기 위한 많은 노력들이 있어 왔으며(You et al. 2021, Huang et al. 2022, Papp and Wattenhofer 2022, Zhang and Li 2021, Loukas 2019, 사토, 야마다, 카시마 2019) 모두 단순(방향이 없는) 그래프에 초점을 맞추고 있습니다.  ★
그러나 단순한 그래프에서도 문제는 해결되지 않았습니다. 
예를 들어, 최근까지도 이론적으로 보장된 6주기를 계산할 수 있는 선형 시간 순열 등가 GNN은 존재하지 않았습니다(Huang 외. 2022).  ★


이 논문은 이 두 가지 문제를 모두 다룹니다. 
우리가 아는 한, 이것은 방향성 멀티그래프를 위해 특별히 설계된 최초의 GNN 아키텍처입니다. 
둘째, 먼저 제안한 아키텍처가 이론적으로 방향성 멀티그래프에서 모든 하위 그래프 패턴을 감지할 수 있음을 증명하고,
그림 1에서 착시된 패턴을 감지할 수 있음을 경험적으로 확인합니다. ---> ★그림 1 == 자금세탁 패턴

우리가 제안한 아키텍처는 모든 표준 GNN 아키텍처를 지향성 멀티그래프 GNN으로 변환할 수 있는 일련의 간단한 적응을 기반으로 합니다. 
이러한 적응은 역방향 메시지 전달(Jaume 외. 2019), 포트 넘버링(Sato, Yamada, Kashima 2019), 에고 ID(You 외. 2021) 등입니다. 
이러한 개별 구성 요소는 기존 문헌에 존재하지만 이들을 결합하는 이론적 및 경험적 힘은 탐구되지 않았습니다. 
이 작업에서 우리는 이 간극을 메웁니다: 이를 결합하여 방향성 멀티그래프에 적용하고, 이를 함께 사용할 때의 이론적 및 경험적 이점을 보여줍니다. 

우리의 기여 
(1) ★메시지 전달 GNN을 입증 가능한 강력한 지향성 다중그래프 신경망으로 변환할 수 있는 일련의 간단하고 학습적인 적응 방법을 제안합니다. 
(2) ego ID, 포트 넘버링, 역방향 메시지 전달을 갖춘 적절히 강력한 GNN이 모든 방향성 서브그래프 패턴을 식별할 수 있음을 증명합니다. 
(3) 이 이론을 합성 그래프에서 테스트하여 이러한 적응을 사용하는 GNN이 최대 길이 6의 방향성 주기, 분산 수집 패턴, 방향성 바이클리크 등 다양한 하위 그래프 패턴을 감지할 수 있어 이전의 GNN 아키텍처와 차별화된다는 것을 확인했습니다. 
(4) 이러한 개선은 두 가지 금융 데이터 세트에서 상당한 성능 향상으로 이어집니다. 자금 세탁 및 피싱 데이터 세트에서 GNN 성능이 크게 향상되어 시뮬레이션 데이터와 실제 데이터 모두에서 최첨단 금융 범죄 탐지 모델과 비슷하거나 이를 능가합니다.



2. Related Work

(1)
(2018)은 표준 MPNN이 기껏해야 와이스파일러-레만(WL) 동형성 테스트만큼 강력하다는 것을 보여주었고, 
이론적으로 WL 테스트의 성능과 일치하는 GNN 아키텍처인 GIN을 제공했습니다. 
★★WL 테스트는 두 개의 비동형 그래프를 점근적으로 거의 확실하게 구분할 수 있지만(Babai, Erdos, Selkow 1980), 표준 MPNN은 특정 그래프에서 사이클과 같은 단순한 하위 구조를 감지할 수 없습니다(Chen et al. 2020, 2019b). 

(2)
이 때문에 연구자들은 표준 MPNN을 뛰어넘는 방법을 모색하게 되었습니다. 
한 가지 방향은 k-튜플 간 메시지 전달을 수행하거나 텐서 기반 모델을 사용하여 보다 강력한 k-WL 동형성 테스트를 에뮬레이션하는 것입니다(Maron et al. 2019; Morris et al. 2019). 
안타깝게도 이러한 모델은 복잡성이 높고 대부분의 애플리케이션에는 비실용적입니다. 

(3)
또 다른 작업은 미리 계산된 기능을 사용하여 GNN을 증강하는 것입니다. 
이러한 작업에서는 서브그래프 개수 추가(Bouritsas 외. 2022; Barceló 외. 2021), 위치 노드 임베딩(Egressy and Wattenhofer 2022; Dwivedi 외. 2021), 랜덤 ID(Abboud 외. 2020; Sato, Yamada, Kashima 2021), 노드 ID(Loukas 2019) 등을 탐구하고 있습니다. 

(4)
서브그래프 GNN이라고 불리는 표현형 GNN의 최근 클래스는 
그래프를 서브그래프의 모음으로 모델링합니다(Frasca 외. 2022; Zhao 외. 2021). 

Papp 등(2021)은 입력에서 무작위 노드를 삭제하고 GNN을 여러 번 실행하여 실행할 때마다 더 많은 정보를 수집합니다. 
Zhang과 Li(2021)는 대신 각 노드 주변의 하위 그래프를 추출하고 이를 바탕으로 GNN을 실행합니다. 
또한 이 범주에 속하는 ID-GNN은 자아 ID를 사용하는데(You 외. 2021), 각 노드를 이웃과 함께 샘플링하고 이웃과 구별할 수 있는 식별자를 부여합니다. 
저자들은 ID-GNN이 주기를 계산할 수 있다고 주장하지만, 그 증명은 잘못된 것으로 밝혀졌습니다. 
실제로 Huang 등(2022)은 서브그래프 GNN의 전체 제품군이 길이가 4보다 큰 사이클을 계산할 수 없음을 보여주고, 
길이 6까지 사이클을 계산할 수 있는 I2-GNN을 제안합니다. 

(5)
방향성 그래프에 대한 GNN에 대한 연구는 훨씬 적었습니다. 
Zhang 등(2021)은 방향성 그래프를 위한 스펙트럼 네트워크를 제안했지만, 
이 네트워크의 성능을 분석하거나 대규모 데이터 세트에 적용하기는 어렵습니다. 

유사한 접근 방식은 (Tong et al. 2020) 및 (Ma et al. 2019)에서 찾을 수 있습니다. 
Jaume 등(2019)은 메시지 전달을 확장하여 수신 및 발신 이웃을 개별적으로 집계하는 대신 그래프를 방향이 없는 것으로 순진하게 취급합니다. 
방향성 다중 그래프는 특별히 고려되지 않았습니다. 

(6)
GNN은 다양한 금융 애플리케이션에 사용되어 왔습니다(Li 외. 2021; Feng 외. 2019; Chen, Wei, and Huang 2018; Zhang 외. 2019; Li 외. 2019; Xu 외. 2021; Yang 외. 2021). 
우리 연구와 가장 가까운 예로, 사기 탐지에 GNN이 사용되었습니다. 
Liang 등(2019)과 Rao 등(2021)은 각각 보험과 신용카드 사기를 밝혀내기 위해 고객-상품 이분법 그래프를 연구했습니다. 
Liu 등(2018)은 온라인 결제 플랫폼의 기기-활동 이분법 그래프에서 악성 계정을 탐지하기 위해 이질적인 GNN을 사용합니다. 
Weber 등(2019)은 자금세탁방지(AML)에 표준 GNN을 최초로 적용했으며, 
최근에는 Car- doso, Saleiro, Bizarro(2022)가 거래 네트워크를 계정-거래 이분 그래프로 표현할 것을 제안하여 반감독 AML 환경에서 유망한 결과를 보여주었습니다. 
그러나 이러한 접근 방식이 일반적인 사기 패턴을 탐지하는 데 어떻게 도움이 되는지는 명확하지 않습니다.



3 Background		##
3.1 Graphs and Financial Transaction Graphs

여기서 노드 v ∈ V(G)는 계좌를 나타내고, 방향이 지정된 에지 e = (u, v) ∈ E(G)는 u에서 v까지의 거래를 나타내는 방향이 지정된 다중 그래프 G를 고려합니다. 
각 노드 u는 (선택적으로) 계좌 특징 집합 h(0)(u)를 가지며, 계좌 번호, 은행 ID, 계좌 잔액 등이 포함될 수 있습니다. 
각 트랜잭션 e = (u, v)에는 트랜잭션의 금액, 통화, 타임스탬프 등 관련 트랜잭션 특징 집합 h(0)(u,v)가 있습니다. 
u의 수신 및 발신 이웃은 각각 Nin(u) 및 Nout(u)로 표시됩니다. 
동일한 두 계정 간의 여러 트랜잭션이 가능하므로 G는 다중 그래프가 됩니다. 
노드(또는 에지) 예측 작업에서 각 노드(또는 에지)에는 해당 계정(또는 거래)의 불법 여부를 나타내는 바이너리 레이블이 있습니다. 

금융 범죄 패턴. ★
그림 1은 자금 세탁을 나타내는 몇 가지 하위 그래프 패턴을 보여줍니다(Granados and Vargas 2022, He 외. 2021, Suzumura 2022, Weber 외. 2018, Starnini 외. 2021). 
안타깝게도 이러한 패턴은 다소 일반적인 패턴으로, 완전히 무고한 거래에서도 광범위하게 나타납니다. 
따라서 금융 범죄를 탐지하려면 개별 패턴을 탐지하는 것뿐만 아니라 관련 조합을 학습하는 것도 중요합니다. 

이러한 이유로 신경망이 이 작업에 적합한 후보로 떠오르고 있습니다. 
그러나 표준 메시지 전달 신경망은 일반적으로 정도 인을 제외하고는 묘사된 패턴을 탐지하지 못합니다. 
다음 섹션에서는 이러한 패턴을 각각 감지할 수 있도록 하는 아키텍처적 적응에 대해 설명합니다. 

하위 그래프 감지. 
하위 그래프 패턴 H가 주어졌을 때, 노드에 대한 하위 그래프 감지를 그래프의 각 노드가 H와 동형인 하위 그래프의 일부인지 여부를 결정하는 것으로 정의합니다, 노드 v ∈ V(G)가 주어졌을 때, v ∈ V(G′) 및 G′ ∼= H가 되는 E(G′) ⊆ E(G) 및 V(G′) ⊆ V(G)를 갖는 그래프 G′의 존재 여부를 결정합니다.



3.2 Message Passing Neural Networks

일반적으로 메시지 전달 신경망(MPNN)이라고 불리는 메시지 전달 GNN은 가장 주목받는 GNN 제품군을 형성합니다. 여기에는 GCN(Kipf와 웰링 2016), GIN(쉬 외. 2018), GAT(벨리코비치 외. 2017), GraphSAGE(해밀턴, 잉, 레스코빅 2017) 등 다양한 아키텍처가 포함됩니다. 

이러한 아키텍처는 세 단계로 작동합니다: 
(1) 각 노드는 자신의 현재 상태 h(v)가 포함된 메시지를 이웃 노드에게 보내고, 
(2) 각 노드는 이웃으로부터 받은 모든 메시지를 임베딩된 a(v)에 집계하며, 
(3) 각 노드는 h(v)와 a(v)를 기반으로 자신의 상태를 업데이트하여 새로운 상태를 생성합니다. 

이 세 단계는 GNN의 한 계층을 구성하며, 이 단계를 반복하여 그래프의 더 먼 곳으로부터 정보를 수집할 수 있습니다. 
좀 더 공식적으로 설명하면:
...




4 Methods 		##

이 섹션에서는 그림 1의 사기 패턴을 탐지할 수 있도록 표준 MPNN(메시지 전달 신경망)을 간단하게 조정하는 방법을 소개합니다. 
탐지하는 데 도움이 되는 패턴의 복잡성이 증가하는 순서대로 적응을 고려합니다. 
이러한 적응을 동기화하기 위한 이론 결과를 제공하고 
7.1절의 합성 하위 그래프 탐지 데이터 세트에 대한 해당 실험을 포함하여 이론을 경험적으로 뒷받침합니다.


4.1 Reverse Message Passing

디렉티드 에지가 있는 표준 MPNN을 사용하는 경우, 
노드는 나가는 이웃(들어오는 이웃일 수도 있음)으로부터 메시지를 수신하지 않으므로 나가는 에지를 계산할 수 없습니다. 
예를 들어, 표준 MPN은 그림 2에서 노드 a와 b를 구분할 수 없습니다. 
또한 에지를 방향이 없는 것으로 취급하고 메시지가 양방향으로 이동하는 순진한 양방향 메시지 전달은 노드가 들어오는 에지와 나가는 에지를 구분할 수 없기 때문에 문제를 해결하지 못합니다. 
따라서 같은 그림에서 노드 a와 d를 구분하지 못합니다. 

이 문제를 극복하려면 어떤 식으로든 에지의 방향을 표시해야 합니다. 
수신 에지와 발신 에지에 각각 별도의 메시지 전달 레이어를 사용하는 것, 즉 역방향 메시지 전달을 추가하는 것을 제안합니다. 

이는 두 개의 에지 유형이 있는 관계형 GNN을 사용하는 것과 유사합니다(Schlichtkrull 외. 2018). 
좀 더 공식적으로는 집계 및 업데이트 메커니즘이 됩니다:
...
여기서 a_in은 이제 들어오는 이웃의 집합이고 a_out은 나가는 이웃의 집합입니다. 이제 역 MP를 사용하는 메시지 전달 GNN이 정도 아웃을 해결할 수 있음을 증명했습니다. 정리 4.1. 합집합과 역 MP를 가진 MPNN은 정도 아웃을 해결할 수 있다. 정리 4.1의 증명은 부록 B에서 찾을 수 있습니다. 7.1절에서는 합성 패턴 탐지 작업을 통해 이론이 실제로 적용되는지 확인합니다.



4.2 Directed Multigraph Port Numbering ★

사람들은 종종 같은 계정으로 여러 거래를 합니다. 

트랜잭션 네트워크에서는 이를 병렬 에지로 표현합니다. 
팬인(또는 팬아웃) 패턴을 감지하려면 모델은 같은 이웃의 에지와 다른 이웃의 에지를 구분해야 합니다. 
고유 계정 번호(또는 일반적인 노드 ID)를 사용하면 자연스럽게 이를 구분할 수 있습니다. 

그러나 계정 번호를 사용하는 것은 일반화가 잘 되지 않습니다. 
훈련 중에 모델은 사기 패턴을 식별하는 학습 없이도 사기성 계좌 번호를 외울 수 있지만, 
이는 보이지 않는 계좌로 일반화되지 않습니다. 

대신 포트 번호 지정(Sato, Yamada, Kashima 2019)을 방향성 다중 그래프에 적용합니다. 
포트 번호 지정은 노드의 각 이웃에 로컬 ID를 부여합니다. 
이를 통해 노드는 연속적인 메시지 전달 라운드에서 동일한 이웃에서 오는 메시지를 식별할 수 있습니다. 

포트 번호 부여를 방향성 멀티그래프에 적용하려면 각 방향성 에지에 수신 및 발신 포트 번호를 할당하고, 
동일한 노드에서 오는(또는 가는) 에지는 동일한 수신(또는 발신) 포트 번호를 받습니다. 
수신 메시지에 노드의 로컬 포트 번호만 첨부하는 Sato, Yamada, Kashima(2019)와 달리, 우리는 양방향으로 포트 번호를 첨부합니다. 

즉, 한 노드는 자신이 이웃에게 할당했던 포트 번호와 이웃이 자신에게 할당했던 포트 번호를 모두 볼 수 있습니다. 
이는 표현성 논증에서 매우 중요한 것으로 밝혀졌습니다. 
포트 번호는 단순한 그래프에서 GNN의 표현력을 향상시키는 것으로 나타났지만, 
포트 번호만 있는 메시지 전달 GNN은 경우에 따라 3주기조차 감지할 수 없습니다(Garg, Jegelka, Jaakkola 2020). 

일반적으로 노드 주변의 포트 번호 할당은 임의적입니다. 
들어오는 이웃이 d개인 노드는 들어오는 포트 번호를 d! 방식으로 할당할 수 있습니다. 
데이터 세트에서 이러한 대칭성을 깨기 위해 트랜잭션 타임스탬프를 사용해 들어오는(또는 나가는) 이웃의 순서를 정합니다. 
평행 에지의 경우, 가장 빠른 타임스탬프를 사용해 이웃의 순서를 결정합니다. 

타임스탬프는 금융 범죄 탐지에서 의미를 갖기 때문에 순서를 선택하는 데 동기가 부여되며, 
실제로 타임스탬프가 다른 두 개의 동일한 하위 그래프 패턴은 서로 다른 의미를 가질 수 있습니다. 

이러한 방식으로 포트 번호를 계산하는 것은 시간 집약적인 단계가 될 수 있으며, 타임스탬프에 따라 모든 에지를 정렬해야 하므로 런타임 복잡성이 지배적입니다: O(mlogm), 여기서 m = |E(G)|입니다. 그러나 포트 번호는 미리 계산할 수 있으므로 학습 및 추론 시간에는 영향을 미치지 않습니다. 각 에지는 수신 및 발신 포트 번호를 추가 에지 피처로 받습니다. 

그림 3은 포트 번호가 포함된 그래프의 예시를 보여줍니다. 이제 포트 번호를 사용하는 GNN이 팬 인과 팬 아웃 패턴을 정확하게 식별할 수 있음을 증명했습니다. 다음 증명과 이후 포트 번호를 사용한 증명은 정확성을 위해 타임스탬프에 의존하지 않는다는 점에 유의하세요. 그러나 포트를 고유하게 식별하는 타임스탬프를 사용할 수 있다면, GNN의 순열 불변성/등분성은 유지될 것입니다. 

제안 4.2. 최대 집계와 다중 그래프 포트 번호 지정이 있는 MPNN은 팬인을 해결할 수 있습니다. 그 증명은 부록 B에 나와 있습니다. 역 MP를 추가하면 팬아웃도 유사하게 해결할 수 있다고 주장할 수 있습니다. 두 명제 모두 7.1절에서 경험적으로 확인되었습니다. 

명제 4.3. 최대 집계, 다중 그래프 포트 번호 지정, 역 MP를 사용하는 MPNN은 팬아웃을 해결할 수 있습니다.


4.3 Ego IDs ★

역 MP와 다중 그래프 포트 번호 지정은 그림 1의 일부 의심스러운 패턴을 탐지하는 데 도움이 되지만, 방향성 주기, 분산-수집 패턴, 방향성 바이클리크를 탐지하는 데는 충분하지 않습니다. You 등(2021)은 그래프에서 주기를 감지하는 데 도움이 되는 에고 ID를 특별히 도입했습니다. 이 아이디어는 '중심' 노드에 고유한 (이진) 특징을 '표시'함으로써 이 노드가 일련의 메시지들이 언제 다시 순환하는지 인식하여 자신이 속한 주기를 감지할 수 있다는 것입니다. 그러나 논문에서 제시된 명제 2의 증명은 잘못된 것으로 밝혀졌으며, 에고 ID만으로는 사이클 탐지가 불가능합니다. 부록의 그림 6에 반대 예시를 제시합니다. 실제로 Huang 등(2022)도 이 증명이 “보행과 경로를 혼동한다”고 지적합니다. 표 1의 개별 결과에서도 이를 확인할 수 있습니다. 에고 ID는 짧은 주기를 감지하는 데는 도움이 되지만, 더 긴 주기를 감지하는 데는 기준선(GIN)에 도움이 되지 않습니다. 이는 이론적으로도 설명할 수 있습니다: 그래프에 루프(노드에서 노드로 이어지는 가장자리)가 없다고 가정하면 중간 노드를 반복할 가능성이 없으므로 시작 노드로 돌아가는 길이 2와 3의 워크도 사이클입니다. 따라서 You 등(2021)의 명제 2가 이러한 경우에 적용되며 GIN+EgoID가 2주기 및 3주기 탐지에 대해 인상적인 F1 점수를 얻을 수 있다는 것은 놀라운 일이 아닙니다. 그러나 역 MP 및 포트 넘버링과 함께 에고 ID는 주기, 분산 수집 패턴, 이분법 하위 그래프를 탐지하여 의심스러운 패턴 목록을 완성할 수 있습니다. 실제로 이러한 적응을 통해 적절하게 강력한 스탠다드 MPNN은 두 개의 비동형 (하위) 그래프를 구별할 수 있으며, 포트 번호 매기기를 일관되게 사용하면 두 개의 동형 (하위) 그래프를 실수로 구별하지 않는다는 것을 보여줄 수 있습니다. 이 두 가지 고유 관계를 충족하는 GNN을 흔히 범용이라고 합니다. 이 증명의 핵심은 에고 ID, 포트 번호, 역 MP를 사용해 그래프의 각 노드에 고유 ID를 할당하는 방법을 보여주는 것입니다. 고유한 노드 ID가 주어지면 충분히 강력한 표준 MPNN이 보편적인 것으로 알려져 있습니다(Loukas 2019; Abboud 외. 2020). 정리 4.4. 포트 번호와 역 MP를 결합한 에고 ID는 연결된 방향성 멀티그래프에서 고유한 노드 ID를 할당하는 데 사용될 수 있습니다. 이 증명의 아이디어는 GNN이 에고 노드의 이웃에 있는 각 노드에 고유 ID를 할당하는 라벨링 알고리즘을 복제하는 방법을 보여주는 것입니다. 라벨링 알고리즘과 전체 증명은 부록 B에 나와 있습니다. 적응의 보편성은 이 정리로부터 이어집니다.
추론 4.4.1. 에고 ID, 포트 번호, 역 MP를 가진 GIN은 이론적으로 모든 지시된 하위 그래프 패턴을 감지할 수 있습니다. 위의 정리 4.4와 루카스(2019)의 정리 3.1을 통해 증명할 수 있습니다. 간단한 비방향성 그래프에 대해서도 비슷한 진술을 할 수 있습니다. 역 MP는 방향이 지정된 에지에서만 증명에 필요하기 때문에 가정에서 제거할 수 있습니다. 정리 4.5. 에고 ID와 포트 번호는 연결된 방향성 없는 그래프에서 고유한 노드 ID를 할당하는 데 사용될 수 있습니다. 정리 4.5.1. 에고 ID와 포트 번호가 있는 GIN은 이론적으로 방향성 없는 그래프에서 모든 하위 그래프를 감지할 수 있습니다. 섹션 7.1의 표 1에 있는 제거 연구는 이론적 분석을 다시 한번 뒷받침합니다. 세 가지 적응을 조합하면 모든 하위 그래프 패턴에 대해 인상적인 점수를 얻을 수 있습니다. 에지의 두 인시던트 노드의 포트 번호를 전달하는 것은 고유한 노드 ID를 추론하는 데 매우 중요하다는 점에 유의하세요. 부록의 그림 5는 간단한 예시를 통해 이를 설명합니다. 특히, 사토, 야마다, 카시마(2019)가 소개한 포트 번호만으로는 충분하지 않습니다.



4.4 Complexity & Runtime

저희는 일련의 적응을 제안하므로 최종 모델 복잡도는 기본 GNN의 선택에 따라 달라집니다. 

부록 C에서 적응으로 인해 발생하는 추가 런타임 비용을 설명합니다. 
대체로, 적응은 일회성 사전 계산 비용인 O(mlog(m))에 더해 런타임 복잡성에 일정한 비용을 추가합니다. 
GIN을 사용한 AML Small HI의 경험적 런타임은 부록 F.5에서 확인할 수 있습니다.




5 Datasets

합성 패턴 탐지 작업. 
그림 1에서 볼 수 있는 AML 하위 그래프 패턴은 제어 가능한 합성 패턴 탐지 작업의 테스트베드를 만드는 데 사용됩니다. 

핵심 설계 원칙은 원하는 하위 그래프 패턴이 그래프에 사후에 삽입되는 것이 아니라 일관되게 나타나도록 하는 것입니다.
 패턴 삽입의 문제점은 무작위 분포가 왜곡된다는 점이며, 노드의 정도와 같은 간단한 지표만으로도 대략적으로 작업을 해결할 수 있습니다. 

예를 들어 무작위 K-정규 그래프를 생성한 다음 패턴을 삽입하는 극단적인 경우를 생각해 보겠습니다. 
패턴에 속하는 노드는 차수가 k를 초과하는지 확인하여 식별할 수 있습니다. 
또한 삽입된 패턴에만 라벨을 붙이면 무작위로 발생하는 패턴을 간과할 수 있습니다. 
원하는 하위 그래프 패턴이 일관되게 나타나도록 하기 위해 무작위 순환 그래프 생성기를 도입했습니다. 

제너레이터와 의사 코드에 대한 자세한 내용은 부록 D.1에서 확인할 수 있습니다. 
패턴 감지 작업에는 정도 인/아웃(인/아웃 에지 수), 팬 인/아웃(고유한 인/아웃 이웃 수), 분산 수집, 방향성 바이클리크, 최대 6개 길이의 방향성 사이클레스가 포함됩니다. 
자세한 설명은 부록 D.2에서 확인할 수 있습니다. 


자금 세탁 방지(AML). 
금융 데이터에 대한 엄격한 개인정보 보호 규정을 고려할 때, 실제 데이터 세트는 쉽게 구할 수 없습니다. 
대신 자금 세탁 시뮬레이션 데이터를 사용합니다(Altman 외, 2023). 

이러한 데이터 세트의 시뮬레이터는 가상 세계에서 에이전트(은행, 기업, 개인)를 모델링하여 금융 거래 네트워크를 생성합니다. 
이 생성기는 잘 정립된 자금세탁 패턴을 사용하여 현실적인 자금세탁(불법) 거래를 추가합니다. 

불법 비율(HI)이 높은 데이터 세트와 불법 비율(LI)이 낮은 데이터 세트 각각 2개씩, 총 2개의 소규모 데이터 세트와 2개의 중간 규모 데이터 세트를 사용합니다. 
데이터 세트 크기와 불법 비율은 부록의 표 4에 나와 있습니다. 
저희는 60-20-20의 시간적 트레인-검증-테스트 분할, 즉 타임스탬프를 기준으로 트랜잭션을 정렬한 후 분할하는 방식을 사용합니다. 
자세한 내용은 부록 E에서 확인할 수 있습니다. 

이더리움 피싱 탐지(ETH). 
은행은 데이터를 공개하지 않기 때문에 실제 데이터 세트를 위해 암호화폐를 사용합니다. 
일부 노드가 피싱 계정으로 분류된 Kaggle에 게시된 이더리움 거래 네트워크를 사용합니다(Chen 외. 2019a). 

일시적인 트레인 검증 테스트 분할을 사용하지만 이번에는 노드를 분할합니다. 
불법 계정이 데이터 세트의 끝부분에 치우쳐 있기 때문에 65-15-20 분할을 사용합니다. 
자세한 내용과 데이터 세트 통계는 부록 E에서 확인할 수 있습니다. 


실제 방향성 그래프 데이터 세트. 
이론 결과와 하위 그래프 탐지 작업은 아키텍처 적응의 일반적인 목적 잠재력을 보여줍니다. 
그러나 실제 벤치마크 데이터 세트에서 모델을 테스트하는 것은 이러한 주장을 더욱 뒷받침하는 데 중요합니다. 

확립된 방향성 다중 그래프 벤치마크가 없기 때문에, 저희는 카멜레온, 다람쥐(Pei 외. 2020), Arxiv-Year(Hu 외. 2020)의 세 가지 다이렉트 그래프 데이터셋을 가지고 이러한 벤치마크에 대한 최신 모델(Rusch 외. 2022)과 저희의 접근 방식을 비교했습니다. 

이러한 데이터 세트는 이 백서의 초점이 아니므로 실험 세부 사항과 결과는 부록에 남겨두고 부록 G를 참조하시기 바랍니다.



6 Experimental Setup



7 Results
7.1 Synthetic Pattern Detection Results


7.2 AML Results

AML 데이터 세트에 대한 결과는 표 2에서 확인할 수 있습니다. 

AML Small HI의 경우, 적응을 통해 GIN의 소수 클래스 F1 점수가 28.7%에서 57.2%로 30% 가까이 향상되었음을 알 수 있습니다. 
가장 큰 개선은 역 MP와 포트 번호 지정으로 F1 점수가 28.7%에서 56.9%로 증가한 반면, 에고 ID는 여기서 큰 차이가 없습니다. 

다른 AML 데이터 세트에 대한 결과도 비슷한 추세를 보여 전체적으로는 14.2%, 14.0%, GIN의 경우 10.7%가 증가했으며, 
적응이 추가될수록 수익률이 감소하는 것으로 나타났습니다. 

포트 번호 지정에 해당하는 두 행(GIN+Ports 및 +Ports)은 단독으로 사용했을 때와 역 MP와 함께 사용했을 때 모두 포트 번호 지정으로 인한 뚜렷한 이득을 나타냅니다. 

에고 ID에 대한 지원은 덜 명확하며, 개별 적응으로 사용할 때는 분명한 이득이 있지만 역 MP 및 포트 번호 지정에 추가할 때는 큰 이득이 없습니다. 
두 개의 GNN 레이어만 사용되었으므로 레이어가 더 추가되고 더 긴 주기가 감지되면 이 결론은 바뀔 수 있습니다. 

전체 적응 세트는 다른 세 가지 기본 모델인 GIN+EU(엣지 업데이트가 있는 GIN), PNA 및 PNA+EU로 테스트했습니다. 
각각의 경우, 그리고 거의 모든 AML 데이터 세트에서 적응 모델을 사용하면 분명한 이득을 얻을 수 있습니다. 
이러한 이득은 이 접근법의 효과와 다용도성을 강조합니다. 
또한 멀티-PNA+EU는 모든 AML 데이터 세트에서 모든 기준선을 능가하는 성능을 보였습니다. 
이는 그래프 기반 피처를 사용하는 트리 기반 방법(XGBoost+GF 및 LightGBM+GF)과 비교할 때 특히 인상적인데, 
수작업으로 제작된 피처가 시뮬레이터에서 사용하는 불법 자금 세탁 패턴과 완벽하게 일치하기 때문입니다. 

또한, 이러한 트리 기반 방법은 이전 금융 애플리케이션에서 SOTA로 사용되었습니다(Weber 외. 2019; Lo, Layeghy, Portmann 2022). 
개별 자금세탁 패턴에 대한 리콜 점수는 부록 I에서 확인할 수 있습니다. 

자금세탁 패턴에 속하는 불법 거래의 대부분이 식별되며, 전체 데이터 세트 점수는 데이터 세트에서 단독(자금세탁 패턴에 속하지 않는) 불법 거래의 비율에 따라 크게 영향을 받는다는 점에 주목할 필요가 있습니다. 
단독 불법 거래는 식별하기가 매우 어렵습니다. GIN 기반 모델의 훈련 시간 및 추론 처리율은 부록의 표 5를 참조하세요.
특히, 모든 적응을 거친 후에도 멀티-GIN의 추론 속도는 단일 GPU에서 여전히 초당 18,000건의 트랜잭션을 초과합니다.




7.3 ETH Results

마지막으로, 실제 금융 범죄 데이터셋인 이더리움 피싱 계정 분류에서 적응을 테스트합니다. 
결과는 표 2에 나와 있습니다. 
AML 데이터셋과 유사하게 적응을 추가하면 최종 점수가 지속적으로 향상되는 것을 확인할 수 있습니다. 

전체적으로 소수 클래스 F1 점수는 적응을 하지 않은 경우 26.9%에서 역 MP, 포트 번호, 에고 ID를 사용한 경우 42.9%로 증가했습니다. 
다시 말해, 가장 큰 단일 개선은 역 MP 덕분입니다. 
이 경우, Multi-GIN은 모든 기준선을 능가하지는 않지만, 
적응을 통해 PNA 성능이 크게 향상되었으며, Multi-PNA와 Multi-PNA+EU는 모든 기준선을 12% 이상 능가했습니다.



8 Conclusion

이 연구는 기존의 메시지 전달 GNN을 강력한 방향성 다중 그래프 학습자로 변환할 수 있는 일련의 간단한 적응을 조사했습니다. 

그래프 신경망 분야에 대한 우리의 기여는 세 가지입니다. 
첫째, 우리의 이론적 분석은 다양한 GNN 적응/증강을 결합하는 힘에 대한 기존 문헌의 주목할 만한 격차를 해결합니다. 
구체적으로, 우리는 ego ID와 포트 번호 매기기 및 역 메시지 전달이 결합된 ego ID가 GIN과 같은 적절하게 강력한 메시지 전달 GNN을 통해 고유한 노드 ID를 계산하고, 그곳에서 모든 방향성 하위 그래프 패턴을 사전에 감지할 수 있음을 증명합니다. 

둘째, 우리의 이론적 발견은 다양한 합성 하위 그래프 탐지 작업을 통해 실증적으로 검증되었습니다. 
실용적인 결과는 이론적 기대와 밀접하게 일치하며, 더 복잡한 하위 그래프를 탐지하기 위해 세 가지 적응의 조합이 필요함을 확인합니다. 

마지막으로, 우리는 우리의 적응이 두 가지 중요한 금융 범죄 문제 문제, 
즉 자금 세탁 거래 탐지와 피싱 계정 탐지에 어떻게 적용될 수 있는지 보여줍니다. 
제안된 적응으로 향상된 GNN은 두 작업 모두에서 관련 기준선과 일치하거나 초과하는 인상적인 결과를 달성합니다. 

그러나 역 메시지 전달과 포트 번호 매기기는 최고 점수에 도달하는 데 다시 중요한 역할을 하지만, 
ego ID가 이러한 데이터셋에 큰 추가적인 이점을 제공하지 않는다는 것을 발견했습니다. 

이 연구는 "금융 범죄 응용"에 초점을 맞추었지만, 이론과 실용적인 결과는 더 넓은 관련성을 가지고 있습니다. 
즉각적인 미래 연구는 우리의 방법을 "다른 방향성 다중 그래프 문제에 적용하는 것"을 탐구하는 것을 포함할 수 있습니다. 

부록에서 초기 탐구를 찾을 수 있으며, 세 가지 실제 데이터셋에서 유망한 결과를 보여줍니다. 
그러나 다양한 도메인에서의 일반적인 적용 가능성을 확인하기 위해서는 추가 실험이 필요합니다. 
또한, 미래 연구는 다양한 하위 그래프 탐지 문제의 계산 복잡성과 GNN 성능 간의 관계를 탐구할 수 있습니다.


