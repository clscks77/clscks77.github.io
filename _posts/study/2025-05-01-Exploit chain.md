---
title: "[Study] 2025-05-01 Exploit chain"
categories: [Study, Security]
tags: [attack, exploit]
date: 2025-05-01 19:03:21 +0900
comments: false
excerpt: "Exploit Chain에 대해 알아보자"
--- 
---



Exploit 체인
> 취약점을 통해 제어 권한(primitive)을 획득하고  
그 결과로 프로그램의 흐름 또는 동작을 공격자가 의도한 방식으로 바꾸는 것
- 즉, Control Flow Hijacking 또는 그에 준하는 공격적 행위가 성공하는 시점까지가 Exploit


1. 취약점 발견 (Vulnerability Identification)
- Fuzzing, static analysis 등을 통해 취약점 발생 위치와 조건 확인
- PoC는 이 단계, "취약점 존재"의 증명


2. 원시 메모리 제어 (Primitive 획득)
- Stack/heap overflow → buffer 밖 memory write (Return address, saved registers, Chunk metadata, vtable pointer, function pointer 등)
- UAF → dangling pointer 통해 arbitrary read/write
- Format string → arbitrary read/write, leak
이러한 과정을 통해 다음 중 하나를 확보하고 제어권 획득의 기반을 만듦
    - Arbitrary Read/Write primitive 
    - Pointer Hijack
    - Control Flow Hijack


3. Memory Layout Manipulation
- Heap Feng Shui, tcache manipulation, buffer reallocation, Spray, grooming, chunk overlapping, fake object crafting 등
- 후속 단계에서 필요한 정확한 주소 조작 또는 payload 삽입을 위해 중요
- Primitive를 실제 공격으로 이어지게 만듦



4. Control Flow Hijacking (제어권 획득 = Exploit 성공)
- 프로그램의 실행 흐름을 공격자가 의도한 대로 변경 = PC (Program Counter) 제어
- ROP/JOP/DOP chain 실행, vtable/GOT overwrite 등을 통해 shellcode 실행 또는 libc 함수 호출 (system, execve) 


5. Payload 실행 및 트리거
- 공격 페이로드(shellcode, command, loader 등)를 실행 가능한 위치에 배치
- 이전 단계에서 hijack한 control flow로 해당 위치로 점프
- system("/bin/sh")


6. 최종 목표 달성 (Exploit의 결과, Impact)
- 실제 행위 (RCE, LPE, Privilege Escalation, Sandbox Escape, 정보 유출 등)


